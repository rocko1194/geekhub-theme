//Lightbox v2.6 by Lokesh Dhakar - http://www.lokeshdhakar.com - Licensed under the Creative Commons Attribution 2.5 License - http://creativecommons.org/licenses/by/2.5/
if(!String.prototype.format){String.prototype.format=function(){var A=arguments;return this.replace(/{(\d+)}/g,function(B,C){return typeof A[C]!="undefined"?A[C]:B})}}(function(){var A,B,C;A=jQuery;C=(function(){function D(){this.fadeDuration=500;this.fitImagesInViewport=lightboxSettings.scaleLightbox;this.resizeDuration=700;this.showImageNumberLabel=lightboxSettings.showimagenumber;this.wrapAround=lightboxSettings.wrapAround}D.prototype.albumLabel=function(E,F){return lightboxSettings.albumLabel.format(E,F)};return D})();B=(function(){function D(E){this.options=E;this.album=[];this.currentImageIndex=void 0;this.init()}D.prototype.init=function(){this.enable();return this.build()};D.prototype.enable=function(){var E=this;return A("body").on("click","a[rel^=lightbox], area[rel^=lightbox], a[data-lightbox], area[data-lightbox]",function(F){E.start(A(F.currentTarget));return false})};D.prototype.build=function(){var E=this;A("<div id='lightboxOverlay' class='lightboxOverlay'></div><div id='lightbox' class='lightbox'><div class='lb-outerContainer'><div class='lb-container'><img class='lb-image' src='' /><div class='lb-nav'><a class='lb-prev' href='' ></a><a class='lb-next' href='' ></a></div><div class='lb-loader'><a class='lb-cancel'></a></div></div></div><div class='lb-dataContainer'><div class='lb-data'><div class='lb-details'><span class='lb-caption'></span><span class='lb-number'></span></div><div class='lb-closeContainer'><a class='lb-close'></a></div></div></div></div>").appendTo(A("body"));this.$lightbox=A("#lightbox");this.$overlay=A("#lightboxOverlay");this.$outerContainer=this.$lightbox.find(".lb-outerContainer");this.$container=this.$lightbox.find(".lb-container");this.containerTopPadding=parseInt(this.$container.css("padding-top"),10);this.containerRightPadding=parseInt(this.$container.css("padding-right"),10);this.containerBottomPadding=parseInt(this.$container.css("padding-bottom"),10);this.containerLeftPadding=parseInt(this.$container.css("padding-left"),10);this.$overlay.hide().on("click",function(){E.end();return false});this.$lightbox.hide().on("click",function(F){if(A(F.target).attr("id")==="lightbox"){E.end()}return false});this.$outerContainer.on("click",function(F){if(A(F.target).attr("id")==="lightbox"){E.end()}return false});this.$lightbox.find(".lb-prev").on("click",function(){if(E.currentImageIndex===0){E.changeImage(E.album.length-1)}else{E.changeImage(E.currentImageIndex-1)}return false});this.$lightbox.find(".lb-next").on("click",function(){if(E.currentImageIndex===E.album.length-1){E.changeImage(0)}else{E.changeImage(E.currentImageIndex+1)}return false});return this.$lightbox.find(".lb-loader, .lb-close").on("click",function(){E.end();return false})};D.prototype.start=function(M){var F,Q,P,L,R,G,N,J,I,O,E,K,H;A(window).on("resize",this.sizeOverlay);A("select, object, embed").css({visibility:"hidden"});this.$overlay.width(A(document).width()).height(A(document).height()).fadeIn(this.options.fadeDuration);this.album=[];R=0;P=M.attr("data-lightbox");if(P){K=A(M.prop("tagName")+'[data-lightbox="'+P+'"]');for(L=J=0,O=K.length;J<O;L=++J){Q=K[L];this.album.push({link:A(Q).attr("href"),title:A(Q).attr("title")});if(A(Q).attr("href")===M.attr("href")){R=L}}}else{if(M.attr("rel")==="lightbox"){this.album.push({link:M.attr("href"),title:M.attr("title")})}else{H=A(M.prop("tagName")+'[rel="'+M.attr("rel")+'"]');for(L=I=0,E=H.length;I<E;L=++I){Q=H[L];this.album.push({link:A(Q).attr("href"),title:A(Q).attr("title")});if(A(Q).attr("href")===M.attr("href")){R=L}}}}F=A(window);N=F.scrollTop()+F.height()/10;G=F.scrollLeft();this.$lightbox.css({top:N+"px",left:G+"px"}).fadeIn(this.options.fadeDuration);this.changeImage(R)};D.prototype.changeImage=function(G){var F,E,H=this;this.disableKeyboardNav();F=this.$lightbox.find(".lb-image");this.sizeOverlay();this.$overlay.fadeIn(this.options.fadeDuration);A(".lb-loader").fadeIn("slow");this.$lightbox.find(".lb-image, .lb-nav, .lb-prev, .lb-next, .lb-dataContainer, .lb-numbers, .lb-caption").hide();this.$outerContainer.addClass("animating");E=new Image();E.onload=function(){var M,J,K,O,I,N,L;F.attr("src",H.album[G].link);M=A(E);K=E.width;J=E.height;F.width(E.width);F.height(E.height);if(H.options.fitImagesInViewport){L=A(window).width();N=A(window).height();I=L-H.containerLeftPadding-H.containerRightPadding-20;O=N-H.containerTopPadding-H.containerBottomPadding-110;if((E.width>I)||(E.height>O)){if((E.width/I)>(E.height/O)){K=I;J=parseInt(E.height/(E.width/K),10);F.width(K);F.height(J)}else{J=O;K=parseInt(E.width/(E.height/J),10);F.width(K);F.height(J)}}}return H.sizeContainer(K,J)};E.src=this.album[G].link;this.currentImageIndex=G};D.prototype.sizeOverlay=function(){return A("#lightboxOverlay").width(A(document).width()).height(A(document).height())};D.prototype.sizeContainer=function(H,E){var G,I,K,F,J=this;F=this.$outerContainer.outerWidth();K=this.$outerContainer.outerHeight();I=H+this.containerLeftPadding+this.containerRightPadding;G=E+this.containerTopPadding+this.containerBottomPadding;this.$outerContainer.animate({width:I,height:G},this.options.resizeDuration,"swing");setTimeout(function(){J.$lightbox.find(".lb-dataContainer").width(I);J.$lightbox.find(".lb-prevLink").height(G);J.$lightbox.find(".lb-nextLink").height(G);J.showImage()},this.options.resizeDuration)};D.prototype.showImage=function(){this.$lightbox.find(".lb-loader").hide();this.$lightbox.find(".lb-image").fadeIn("slow");this.updateNav();this.updateDetails();this.preloadNeighboringImages();this.enableKeyboardNav()};D.prototype.updateNav=function(){this.$lightbox.find(".lb-nav").show();if(this.album.length>1){if(this.options.wrapAround){this.$lightbox.find(".lb-prev, .lb-next").show()}else{if(this.currentImageIndex>0){this.$lightbox.find(".lb-prev").show()}if(this.currentImageIndex<this.album.length-1){this.$lightbox.find(".lb-next").show()}}}};D.prototype.updateDetails=function(){var E=this;if(typeof this.album[this.currentImageIndex].title!=="undefined"&&this.album[this.currentImageIndex].title!==""){this.$lightbox.find(".lb-caption").html(this.album[this.currentImageIndex].title).fadeIn("fast")}if(this.album.length>1&&this.options.showImageNumberLabel){this.$lightbox.find(".lb-number").text(this.options.albumLabel(this.currentImageIndex+1,this.album.length)).fadeIn("fast")}else{this.$lightbox.find(".lb-number").hide()}this.$outerContainer.removeClass("animating");this.$lightbox.find(".lb-dataContainer").fadeIn(this.resizeDuration,function(){return E.sizeOverlay()})};D.prototype.preloadNeighboringImages=function(){var F,E;if(this.album.length>this.currentImageIndex+1){F=new Image();F.src=this.album[this.currentImageIndex+1].link}if(this.currentImageIndex>0){E=new Image();E.src=this.album[this.currentImageIndex-1].link}};D.prototype.enableKeyboardNav=function(){A(document).on("keyup.keyboard",A.proxy(this.keyboardAction,this))};D.prototype.disableKeyboardNav=function(){A(document).off(".keyboard")};D.prototype.keyboardAction=function(H){var J,I,F,G,E;J=27;I=37;F=39;E=H.keyCode;G=String.fromCharCode(E).toLowerCase();if(E===J||G.match(/x|o|c/)){this.end()}else{if(G==="p"||E===I){if(this.currentImageIndex!==0){this.changeImage(this.currentImageIndex-1)}}else{if(G==="n"||E===F){if(this.currentImageIndex!==this.album.length-1){this.changeImage(this.currentImageIndex+1)}}}}};D.prototype.end=function(){this.disableKeyboardNav();A(window).off("resize",this.sizeOverlay);this.$lightbox.fadeOut(this.options.fadeDuration);this.$overlay.fadeOut(this.options.fadeDuration);return A("select, object, embed").css({visibility:"visible"})};return D})();A(function(){var E,D;D=new C();return E=new B(D)})}).call(this);